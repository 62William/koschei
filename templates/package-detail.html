{% extends "base.html" %}
{% import "macros.html" as macros %}
{% block content %}
<div class="pageHeader">{{ package.name }}</div>
{% if package.state_string == 'unresolved' %}
<table class="nested-data-list">
    <tr class="list-header">
        <th>Dependency problems</th>
    </tr>
    {% for problem in package.resolution_result.problems %}
    <tr>
        <td>{{ problem.problem }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}
{% if package.unapplied_changes %}
<table class="nested">
    <tr>
        <th colspan="4">Dependency changes since last build</th>
    </tr>
    {{ macros.depchange_table(package.unapplied_changes) }}
</table>
{% endif %}
<table class="nested data-list">
  <thead>
    <tr class="list-header">
        <th>State</th>
        <th>Koji task</th>
        <th>Started</th>
        <th>Dependency changes</th>
        <th>Build details</th>
    </tr>
  </thead>
  <tbody>
    {% for build in package.all_builds %}
    <tr class="row-odd">
        <td><div class="hidden">{{ build.state_string }}</div>
            <img src="{{ url_for('static', filename='images/' ~ build.state_string ~ '.png') }}"
                 title="{{ build.state_string }}" alt="{{ build.state_string }}"/></td>
        <td>
            <a href="{{ koji_weburl }}/taskinfo?taskID={{ build.task_id }}">
                {{ build.task_id }}
            </a>
        </td>
        <td>
            {{ build.started | date }}
        </td>
        <td>
            {{ macros.depchange_table(build.dependency_changes, limit=10,
                more_link=url_for('build_detail', name=package.name, build_id=build.id)) }}
        </td>
        <td>
            <a href="{{ url_for('build_detail', name=package.name, build_id=build.id) }}">details</a>
        </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
