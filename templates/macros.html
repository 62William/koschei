{% macro pagination_row(page, what) %}
<div>
    <span class="paginate">{{ what }} from {{ (page.page - 1) * page.per_page + 1}} to
                           {{ min(page.page * page.per_page, page.total) }} from total
                           {{ page.total }}</span>
    <form class="pageJump" action="">
        Page:
        <select onchange="javascript: window.location = '?page=' + this.value;">
            {% for i in range(1, page.page) %}
            <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
            <option value="{{ page.page }}" selected="selected">{{ page.page }}</option>
            {% for i in range(page.page + 1, page.pages + 1) %}
            <option value="{{ i }}">{{ i }}</option>
            {% endfor %}
        </select>
    </form>
</div>
{% endmacro %}
{% macro package_table(packages, page) %}
{% if page %}
{{ pagination_row(page, 'Packages') }}
{% endif %}
<table class="data-list">
    <thead>
        <tr class="list-header">
            <th>Name</th>
            <th>State</th>
            <th>Task ID</th>
            <th>Started</th>
        </tr>
    </thead>
    <tbody>

    {% for package in packages %}
    {% set last_build = package.last_build %}

    <tr class="row-odd pkg-{{ package.state_string }}">
        <td>
            <a href="{{ url_for('package_detail', name=package.name) }}">{{ package.name }}</a>
        </td>
        <td>
            <div class="hidden">{{ package.state_string }}</div>
            {% if package.state_string %}
            <img src="{{ url_for('static', filename='images/' ~ package.state_string ~ '.png') }}"
                 title="{{ package.state_string }}" alt="{{ package.state_string }}"/>
            {% endif %}
        </td>
        {% if package.state_string != 'unresolved' %}
        <td>
            <a href="{{ koji_weburl }}/taskinfo?taskID={{ last_build.task_id }}">
                {{ last_build.task_id }}
            </a>
        </td>
        <td>
            {{ last_build.started | date }}
        </td>
        {% else %}
        <td colspan="2"/>
        {% endif %}
    </tr>
    {% endfor %}
    </tbody>
</table>
{% endmacro %}
{% macro depchange_table(changes) %}
<table class="nested-data-list" style="width:100%">
    {% for change in changes[:10] %}
    <tr>
        <td>{{ change.dep_name }}</td>
        <td>{{ change.prev_dep_evr or '' }}</td>
        <td>
            {% if change.is_update %}
            &gt;&gt;&gt;
            {% else %}
            &lt;&lt;&lt;
            {% endif %}
        </td>
        <td>{{ change.curr_dep_evr or '' }}</td>
    </tr>
    {% if loop.index == 10 %}
    <tr><td colspan="4">...</td></tr>
    {% endif %}
    {% endfor %}
</table>
{% endmacro %}
